<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="751px" preserveAspectRatio="none" style="width:1022px;height:751px;background:#FFFFFF;" version="1.1" viewBox="0 0 1022 751" width="1022px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="740.5391" style="stroke:#000000;stroke-width:1.5;" width="1016.5" x="0" y="5"/><path d="M374,5 L374,14.4883 L364,24.4883 L0,24.4883 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="364" x="3" y="19.5352">sequence: rpi_control_frmwrk - runtime - IR Protocol</text><rect fill="#F0F0F0" height="703.8086" style="stroke:#181818;stroke-width:0.5;" width="696.5" x="21" y="32.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="71" x="333.75" y="45.0566">IR Protocol</text><rect fill="none" height="186.8184" style="stroke:#000000;stroke-width:1.5;" width="1005.5" x="5" y="481.502"/><rect fill="none" height="90.8867" style="stroke:#000000;stroke-width:1.5;" width="773.5" x="227" y="570.4336"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="89" x2="89" y1="99.7754" y2="685.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="285" x2="285" y1="99.7754" y2="685.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="391" x2="391" y1="99.7754" y2="685.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="519.5" x2="519.5" y1="99.7754" y2="685.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="651.5" x2="651.5" y1="99.7754" y2="685.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="765.5" x2="765.5" y1="99.7754" y2="685.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="860.5" x2="860.5" y1="99.7754" y2="685.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="951.5" x2="951.5" y1="99.7754" y2="685.3203"/><rect fill="#E3E3E3" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="128" x="25" y="51.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="32" y="72.334">IR-Protocol Task</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="71" y="88.8223">:Task</text><rect fill="#E3E3E3" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="128" x="25" y="684.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="32" y="704.8555">IR-Protocol Task</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="71" y="721.3438">:Task</text><rect fill="#E3E3E3" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96" x="237" y="51.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="246" y="72.334">IR-Protocol</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="244" y="88.8223">:IR-Protocol</text><rect fill="#E3E3E3" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96" x="237" y="684.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="246" y="704.8555">IR-Protocol</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="244" y="721.3438">:IR-Protocol</text><rect fill="#E3E3E3" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="97" x="343" y="51.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="350" y="72.334">IR-CMD Slot</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="376.5" y="88.8223">:Slot</text><rect fill="#E3E3E3" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="97" x="343" y="684.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="350" y="704.8555">IR-CMD Slot</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="376.5" y="721.3438">:Slot</text><rect fill="#E3E3E3" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120" x="459.5" y="51.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="466.5" y="72.334">IR-Cmd-Queue</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49" x="495" y="88.8223">:Queue</text><rect fill="#E3E3E3" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120" x="459.5" y="684.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="466.5" y="704.8555">IR-Cmd-Queue</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49" x="495" y="721.3438">:Queue</text><rect fill="#E3E3E3" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124" x="589.5" y="51.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="596.5" y="72.334">Transmit-Buffer</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="629" y="88.8223">:Buffer</text><rect fill="#E3E3E3" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124" x="589.5" y="684.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="596.5" y="704.8555">Transmit-Buffer</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="629" y="721.3438">:Buffer</text><rect fill="#E3E3E3" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85" x="723.5" y="51.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="730.5" y="72.334">Frequency</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="744" y="88.8223">:Timer</text><rect fill="#E3E3E3" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85" x="723.5" y="684.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="730.5" y="704.8555">Frequency</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="744" y="721.3438">:Timer</text><rect fill="#E3E3E3" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85" x="818.5" y="51.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="825.5" y="72.334">Modulator</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="839" y="88.8223">:Timer</text><rect fill="#E3E3E3" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85" x="818.5" y="684.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="825.5" y="704.8555">Modulator</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="839" y="721.3438">:Timer</text><rect fill="#E3E3E3" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="913.5" y="51.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="920.5" y="72.334">MOD-PIN</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="933.5" y="88.8223">:GPIO</text><rect fill="#E3E3E3" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="913.5" y="684.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="920.5" y="704.8555">MOD-PIN</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="933.5" y="721.3438">:GPIO</text><polygon fill="#181818" points="379.5,127.0859,389.5,131.0859,379.5,135.0859,383.5,131.0859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="5" x2="385.5" y1="131.0859" y2="131.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220" x="12" y="126.3438">SIGNAL_IR_CMD_RECEIVED(ir_cmd)</text><polygon fill="#181818" points="507.5,156.3965,517.5,160.3965,507.5,164.3965,511.5,160.3965" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="391.5" x2="513.5" y1="160.3965" y2="160.3965"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="398.5" y="155.6543">enqueue(ir_cmd)</text><polygon fill="#181818" points="77,185.707,87,189.707,77,193.707,81,189.707" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="5" x2="83" y1="189.707" y2="189.707"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="12" y="184.9648">run()</text><polygon fill="#181818" points="507.5,215.0176,517.5,219.0176,507.5,223.0176,511.5,219.0176" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="89" x2="513.5" y1="219.0176" y2="219.0176"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="96" y="214.2754">dequeue(ir_cmd)</text><line style="stroke:#181818;stroke-width:1.0;" x1="89" x2="131" y1="248.3281" y2="248.3281"/><line style="stroke:#181818;stroke-width:1.0;" x1="131" x2="131" y1="248.3281" y2="261.3281"/><line style="stroke:#181818;stroke-width:1.0;" x1="90" x2="131" y1="261.3281" y2="261.3281"/><polygon fill="#181818" points="100,257.3281,90,261.3281,100,265.3281,96,261.3281" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="96" y="243.5859">select_protocol(ir_cmd_type)</text><polygon fill="#181818" points="273,286.6387,283,290.6387,273,294.6387,277,290.6387" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="89" x2="279" y1="290.6387" y2="290.6387"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="96" y="285.8965">transmit(ir_cmd)</text><polygon fill="#181818" points="639.5,315.9492,649.5,319.9492,639.5,323.9492,643.5,319.9492" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="285" x2="645.5" y1="319.9492" y2="319.9492"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="292" y="315.207">prepare()</text><polygon fill="#181818" points="754,345.2598,764,349.2598,754,353.2598,758,349.2598" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="285" x2="760" y1="349.2598" y2="349.2598"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="292" y="344.5176">configure()</text><polygon fill="#181818" points="849,374.5703,859,378.5703,849,382.5703,853,378.5703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="285" x2="855" y1="378.5703" y2="378.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="292" y="373.8281">configure()</text><polygon fill="#181818" points="940,403.8809,950,407.8809,940,411.8809,944,407.8809" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="285" x2="946" y1="407.8809" y2="407.8809"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="292" y="403.1387">drive_low()</text><polygon fill="#181818" points="754,433.1914,764,437.1914,754,441.1914,758,437.1914" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="285" x2="760" y1="437.1914" y2="437.1914"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="37" x="292" y="432.4492">start()</text><polygon fill="#181818" points="849,462.502,859,466.502,849,470.502,853,466.502" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="285" x2="855" y1="466.502" y2="466.502"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="37" x="292" y="461.7598">start()</text><rect fill="none" height="186.8184" style="stroke:#000000;stroke-width:1.5;" width="1005.5" x="5" y="481.502"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="15" y="495.0703">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="143" x="89" y="494.1367">[until command finished]</text><polygon fill="#181818" points="273,519.123,283,523.123,273,527.123,277,523.123" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="5" x2="279" y1="523.123" y2="523.123"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="12" y="518.3809">irq_callback()</text><path d="M290,503.8125 L290,528.8125 L615,528.8125 L615,513.8125 L605,503.8125 L290,503.8125 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M605,503.8125 L605,513.8125 L615,513.8125 L605,503.8125 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304" x="296" y="521.3809">Callback is executed by IRQ of Modulator-Timer</text><polygon fill="#181818" points="639.5,551.4336,649.5,555.4336,639.5,559.4336,643.5,555.4336" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="285" x2="645.5" y1="555.4336" y2="555.4336"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="292" y="550.6914">get_next()</text><path d="M227,570.4336 L289,570.4336 L289,577.7441 L279,587.7441 L227,587.7441 L227,570.4336 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="90.8867" style="stroke:#000000;stroke-width:1.5;" width="773.5" x="227" y="570.4336"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="242" y="584.002">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="52" x="304" y="583.0684">[is pulse]</text><polygon fill="#181818" points="940,605.0547,950,609.0547,940,613.0547,944,609.0547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="285" x2="946" y1="609.0547" y2="609.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="292" y="604.3125">drive_high()</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="227" x2="1000.5" y1="618.0547" y2="618.0547"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="54" x="232" y="628.6895">[is pause]</text><polygon fill="#181818" points="940,649.3203,950,653.3203,940,657.3203,944,653.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="285" x2="946" y1="653.3203" y2="653.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="292" y="648.5781">drive_low()</text><!--MD5=[a41c742becd10d6f4ec39a09ba70bb62]
@startuml rpi_control_frmwrk_uml_runtime_sequence_ir_protocol_interface

'***************************************************************************

skinparam monochrome true
skinparam linetype ortho

'***************************************************************************

mainframe sequence: rpi_control_frmwrk - runtime - IR Protocol

'***************************************************************************

box "IR Protocol" #F0F0F0
    participant "IR-Protocol Task\n:Task" as ir_protocol_task
    participant "IR-Protocol\n:IR-Protocol" as ir_protocol
    participant "IR-CMD Slot\n:Slot" as ir_cmd_slot
    participant "IR-Cmd-Queue\n:Queue" as ir_cmd_queue
    participant "Transmit-Buffer\n:Buffer" as ir_transmit_buffer
end box

participant "Frequency\n:Timer" as frequency
participant "Modulator\n:Timer" as modulator
participant "MOD-PIN\n:GPIO" as mod_gpio

'***************************************************************************

[-> ir_cmd_slot : SIGNAL_IR_CMD_RECEIVED(ir_cmd)
ir_cmd_slot -> ir_cmd_queue : enqueue(ir_cmd)

[-> ir_protocol_task : run()
ir_protocol_task -> ir_cmd_queue : dequeue(ir_cmd)
ir_protocol_task -> ir_protocol_task : select_protocol(ir_cmd_type)
ir_protocol_task -> ir_protocol : transmit(ir_cmd)

ir_protocol -> ir_transmit_buffer : prepare()
ir_protocol -> frequency : configure()
ir_protocol -> modulator : configure()

ir_protocol -> mod_gpio : drive_low()
ir_protocol -> frequency : start()
ir_protocol -> modulator : start()

loop until command finished
    [-> ir_protocol : irq_callback()

    note right
        Callback is executed by IRQ of Modulator-Timer
    end note

    ir_protocol -> ir_transmit_buffer : get_next()
    alt is pulse
        ir_protocol -> mod_gpio : drive_high()
    else is pause
        ir_protocol -> mod_gpio : drive_low()
    end
end

'***************************************************************************

@enduml

@startuml rpi_control_frmwrk_uml_runtime_sequence_ir_protocol_interface


skinparam monochrome true
skinparam linetype ortho


mainframe sequence: rpi_control_frmwrk - runtime - IR Protocol


box "IR Protocol" #F0F0F0
    participant "IR-Protocol Task\n:Task" as ir_protocol_task
    participant "IR-Protocol\n:IR-Protocol" as ir_protocol
    participant "IR-CMD Slot\n:Slot" as ir_cmd_slot
    participant "IR-Cmd-Queue\n:Queue" as ir_cmd_queue
    participant "Transmit-Buffer\n:Buffer" as ir_transmit_buffer
end box

participant "Frequency\n:Timer" as frequency
participant "Modulator\n:Timer" as modulator
participant "MOD-PIN\n:GPIO" as mod_gpio


[-> ir_cmd_slot : SIGNAL_IR_CMD_RECEIVED(ir_cmd)
ir_cmd_slot -> ir_cmd_queue : enqueue(ir_cmd)

[-> ir_protocol_task : run()
ir_protocol_task -> ir_cmd_queue : dequeue(ir_cmd)
ir_protocol_task -> ir_protocol_task : select_protocol(ir_cmd_type)
ir_protocol_task -> ir_protocol : transmit(ir_cmd)

ir_protocol -> ir_transmit_buffer : prepare()
ir_protocol -> frequency : configure()
ir_protocol -> modulator : configure()

ir_protocol -> mod_gpio : drive_low()
ir_protocol -> frequency : start()
ir_protocol -> modulator : start()

loop until command finished
    [-> ir_protocol : irq_callback()

    note right
        Callback is executed by IRQ of Modulator-Timer
    end note

    ir_protocol -> ir_transmit_buffer : get_next()
    alt is pulse
        ir_protocol -> mod_gpio : drive_high()
    else is pause
        ir_protocol -> mod_gpio : drive_low()
    end
end


@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>